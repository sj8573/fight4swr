<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>兒少社會工作</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      background: #f8f6ff;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 700px;
      margin: 32px auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.10);
      padding: 32px 24px 24px 24px;
    }
    h1 {
      margin-top: 0;
      font-size: 2.2rem;
      color: #6c5ce7;
      text-align: center;
      letter-spacing: 2px;
    }
    h2 {
      font-size: 1.1rem;
      color: #b2bec3;
      text-align: center;
      font-weight: normal;
      margin-top: 0;
      margin-bottom: 24px;
    }
    .btn-group {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin: 24px 0 32px 0;
    }
    button {
      background: linear-gradient(90deg,#fdcbf1 0%,#a1c4fd 100%);
      color: #2d3436;
      border: none;
      border-radius: 8px;
      padding: 14px 32px;
      font-size: 1.2rem;
      cursor: pointer;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(200,200,200,0.10);
      transition: background 0.2s;
    }
    button:hover, button:focus {
      background: linear-gradient(90deg,#a1c4fd 0%,#fdcbf1 100%);
    }
    .progress {
      height: 12px;
      background: #ffeaa7;
      border-radius: 6px;
      margin-bottom: 24px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      background: #fab1a0;
      width: 0%;
      transition: width 0.3s;
    }
    .question-card {
      margin-bottom: 24px;
    }
    .question {
      font-size: 1.3rem;
      margin-bottom: 18px;
      color: #00b894;
      font-weight: bold;
    }
    .options {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    .option {
      background: #ffeaa7;
      border: 2px solid #fdcbf1;
      border-radius: 10px;
      padding: 16px 18px;
      cursor: pointer;
      font-size: 1.15rem;
      font-weight: bold;
      transition: background 0.2s, border 0.2s;
      display: flex;
      align-items: center;
      letter-spacing: 1px;
    }
    .option.selected {
      background: #a1c4fd;
      border: 2px solid #6c5ce7;
      color: #2d3436;
    }
    .option.correct {
      background: #dff9fb;
      border: 2px solid #00b894;
      color: #00b894;
    }
    .option.incorrect {
      background: #fab1a0;
      border: 2px solid #d63031;
      color: #d63031;
    }
    .actions {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      margin-top: 24px;
    }
    .timer {
      text-align: right;
      font-size: 1.1rem;
      color: #636e72;
      margin-bottom: 12px;
      font-weight: bold;
    }
    .summary {
      text-align: center;
      margin-top: 32px;
    }
    .score {
      font-size: 2rem;
      color: #00b894;
      margin-bottom: 12px;
      font-weight: bold;
    }
    .review {
      margin-top: 32px;
      background: #f8fafc;
      border-radius: 12px;
      padding: 18px 12px;
    }
    .review h3 {
      margin-top: 0;
      color: #6c5ce7;
      font-size: 1.2rem;
    }
    .review-item {
      margin-bottom: 18px;
      padding-bottom: 12px;
      border-bottom: 1px solid #e0e7ef;
    }
    .review-item:last-child {
      border-bottom: none;
    }
    .review-q {
      font-weight: bold;
      color: #00b894;
      font-size: 1.1rem;
    }
    .review-a {
      margin-left: 8px;
      font-size: 1rem;
    }
    .review-correct {
      color: #00b894;
      font-weight: bold;
    }
    .review-wrong {
      color: #d63031;
      font-weight: bold;
    }
    .download-group {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-top: 24px;
    }
    @media (max-width: 700px) {
      .container { padding: 12px 2px 8px 2px; }
      h1 { font-size: 1.3rem; }
      .question { font-size: 1.1rem; }
      .option { font-size: 1rem; }
    }
  </style>
</head>
<body>
  <div class="container" id="app"></div>
  <script>
// 題庫資料（50題，已隨機排列）
const questions = [
  {q:"政府對發展遲緩兒童，應按其需要給予特殊照顧。下列服務中，何者並非發展遲緩兒童立即性需求？",options:["早期療育","醫療","就學","就養"],answer:4},
  {q:"依據我國兒童及少年福利與權益保障法，下列有關「兒童及少年」的年齡範定之敘述，何者正確？",options:["「兒童」指的是未滿12歲之人","「青少年」指的是12歲以上未滿15歲之人","「少年」指的是12歲以上未滿20歲之人","「幼兒」指的是未滿7歲之人"],answer:1},
  {q:"直轄市、縣(市)主管機關對於依少年事件處理法交付安置輔導或感化教育結束、停止或免除，或經交付轉介輔導之兒童、少年及其家庭，應予追蹤輔導：",options:["至少1年","至少2年","至少3年","至少4年"],answer:1},
  {q:"有下列情事，何者並非兒童及少年福利與權益保障法第81條的規定，不得擔任兒童及少年福利機構或兒童課後照顧服務班及中心之負責人或工作人員？",options:["有性騷擾行為，經有罪判決確定","有性侵害行為，被起訴","行為不檢損害兒童及少年權益，其情節重大，經有關機關查證屬實","身心狀況違常，經主管機關委請相關專科醫師認定不能執行業務"],answer:2},
  {q:"依據『聯合國兒童權利公約』第 31 條指出『兒童及少年有從事適合其年齡之遊戲與娛樂活動之權利』。對兒童及少年來說，遊戲的正面功能不包括下列那一項？",options:["有助於免於貧窮","有助於語言發展","有助於情緒放鬆與調適","有助於社會關係的學習"],answer:1},
  {q:"兒童的家外安置被視為是兒童福利服務的最後一道防線，其最主要的原因為何？",options:["家外安置的服務提供者不易培養，供給有限","家外安置的服務成本太高，排擠其他兒童福利資源","研究顯示，長期接受寄養或機構服務的兒童，在不同照顧系統間流轉，其心理創傷及行為問題的改變成效一直備受質疑","家外安置服務的專業系統太為複雜，對兒童會有適應上的困難"],answer:3},
  {q:"最近國內學者借用美國兒童福利聯盟有關兒童的家庭服務實施內容，將家庭服務內涵分為三類，下列敘述何者錯誤？",options:["家庭支持服務：社區化的服務提供以支持及協助父母親職角色的扮演","家庭中心服務：運用一系列的工作方法，如個案管理、諮商輔導、實務補助等協助家庭度過難關","家庭維繫服務：提供各種密集性家庭服務、倡導服務等給發生危機的家庭","家為基礎服務：短期的危機介入服務，提供家族治療與具體服務"],answer:4},
  {q:"確保兒童在成長過程中，不因年齡、種族、性別及社會階級等而受到差別對待，這是反映何種兒童價值觀？",options:["兒童剝奪","兒童人權","社會排除","社會歧視"],answer:2},
  {q:"根據我國2011年所實施的「兒童及少年福利與權益保障法」之規定，安置兩年以上之兒童及少年，經主管機關評估其家庭功能不全或無法返家者，社會工作者應提出下列何種計畫？",options:["家庭維繫計畫","長期輔導計畫","課後服務計畫","特別看護計畫"],answer:2},
  {q:"有關兒童福利服務的敘述，下列何者錯誤？",options:["寄養服務屬於支持性服務","補充性服務目的在於彌補家庭對子女照顧功能不足","機構教養屬於替代性服務","家庭津貼屬於補充性服務"],answer:1},
  {q:"家庭不僅具有養育，照顧兒童的功能，也是塑造其價值觀、情感、人格等各方面的初級團體。請問家庭對兒童的重要性，下列敘述何者正確？",options:["夫妻離婚會導致兒童身心調適產生問題","兒童已具備獨立生活的個體","兒童大多數的生活資源容易取得","家庭健全與兒童成長的關係不大"],answer:1},
  {q:"少年法院依少年調查官調查之結果，認為情節輕微，以不付審理為適當者，得為不付審理之裁定，處分不包括下列那一項？",options:["轉介兒童或少年福利或教養機構為適當之輔導","安置","告誡","交付兒童或少年之法定代理人或現在保護少年之人嚴加管教"],answer:2},
  {q:"有關兒少保護親子探視的敘述，下列何者錯誤？",options:["定期探視提高家庭重聚的可能性","社會工作者應協助家庭成員降低探視焦慮感與傷感","探視時間只要家人願意，應儘可能安排","探視結束時孩子有退縮行為或生氣情緒，應永久終止探視"],answer:4},
  {q:"兒童司法權的主張，除了強調兒童享有和成人一樣憲法保障之基本權利，同時也應享有與成人不一樣的法律程序保障，因此兒童犯罪時，下列何者不是屬於法律程序保障內涵？",options:["社工陪同出庭","避免重複訊問","隱私權保障","心理支持"],answer:4},
  {q:"從事兒童工作的社會工作者主要扮演的角色，下列何者不正確？",options:["個案管理者","提供直接服務者","倡導者","照顧者"],answer:4},
  {q:"「建構友善托育環境－保母托育管理與托育費用補助實施計畫」支持父母兼顧就業和育兒，針對就業者提供部分托育費用，以協助家長解決托兒問題，使能投入就業市場，減輕家庭照顧及經濟負擔。請問上述計畫屬於兒童及少年福利服務中的那一種類別？",options:["支持性服務","補充性服務","替代性服務","保護性服務"],answer:2},
  {q:"依據「兒童及少年福利與權益保障法」，兒童因不當對待或未受適當照顧而有緊急安置必要時，除例外情形聲請法院裁定外，緊急安置至多不得超過幾小時？",options:["24小時","48小時","72小時","96小時"],answer:3},
  {q:"下列何者對於兒童少年保護工作的描述是錯誤的？",options:["警察、醫師對於發現受虐事實的兒童和少年有通報的責任","即使社會工作者發現孩子需要被保護安置時，除非有法院的判決，否則也只能做緊急的72小時安置","六歲以下的孩子因為照顧者疏忽，導致意外墜樓時，不屬於兒童保護案件","如果照顧者確實有管教不當的虐待事實時，可以要求對其進行強制親職教育"],answer:3},
  {q:"臺灣於那一年開始實施兒童權利公約施行法？",options:["西元1989年","西元2003年","西元2014年","西元2017年"],answer:3},
  {q:"以下為社會工作者所訪問的兒童疏忽個案，「我好像走入一個垃圾場，在雜亂的房間中，我看到一個黑瘦、吃驚的女孩，大約四歲，她身上非常的髒，手腳頭髮都是滿滿的食物碎片或汁液，家裡的環境充滿垃圾及排泄物...」。這個案例是屬於那一種類型的兒童疏忽？",options:["情緒疏忽","不正當環境","身體疏忽","身體虐待"],answer:3},
  {q:"早期發覺發展遲緩的兒童，及時給予適當的醫療照護與社會福利服務，可稱為：",options:["托育養護","早期療育","身心障礙教養","轉銜服務"],answer:2},
  {q:"下列何者並非兒童福利服務的類型？",options:["支持性","補充性","替代性","教育性"],answer:4},
  {q:"對於不適宜在家庭教養之兒少，依據「兒童及少年福利與權益保障法施行細則」第10條之規定，應以下列那一項安置場域為優先考慮？",options:["適當之親屬","與兒少有長期正向穩定依附關係之第三人","登記合格之寄養家庭","核准立案之安置及教養機構"],answer:1},
  {q:"社工人員為能接觸因逃學逃家在外遊蕩，或沉溺於網咖、撞球場遊樂場所的青少年，經常採取下列那一種工作方法？",options:["外展工作","個案管理","資源連結","陪同"],answer:1},
  {q:"兒童少年保護領域中，一般論及家外安置服務，下列敘述何者正確？",options:["兒童福利服務的第一道防線","屬於支持性服務","將兒童或少年安置於原生家庭以外之服務","家外安置照顧者與兒童或少年無血緣關係"],answer:3},
  {q:"依據我國兒童及少年福利與權益保障法施行細則，安置兒童及少年時應優先考慮那一個安置場域？",options:["合適之親屬家庭","登記合格之寄養家庭","經核准立案之兒童及少年安置及教養機構","經縣市政府立案的兒童之家"],answer:1},
  {q:"下列何者非屬於青少年社會工作原則？",options:["生活化原則","發展性原則","非主流化原則","社區化原則"],answer:3},
  {q:"下列那一項服務方案，是針對貧窮家庭、弱勢家庭或移民家庭的兒童所提供的早期介入服務，希望協助兒童在身體、語言、社會技巧、認知學習、情緒表達上有適切發展？",options:["啟蒙方案","自立生活準備方案","工讀脫貧方案","職涯輔導方案"],answer:1},
  {q:"如果你是兒童少年保護的社會工作者，依海渥斯等人(Hepworth et al1997)指出，可以用那些指標來評估兒童性虐待？①身體指標 ②情緒指標 ③人際指標 ④認知指標 ⑤行為指標 ⑥經濟指標",options:["僅①②③","僅④⑤⑥","①②③④⑤","②③④⑤⑥"],answer:3},
  {q:"關於少年網路沉迷或成癮的敘述，下列何者正確？",options:["因為壓力心煩而上網，取得放鬆和愉悅感，再上網後產生罪惡感，又再導致壓力心煩","網路成癮者能夠自主控制上網渴望和衝動","網路成癮者的離線空窗期，不會影響情緒或日常工作","上網依賴產生時，上網時數和次數會遞減"],answer:1},
  {q:"我國兒童少年福利相關法律的發展，下列敘述何者錯誤？",options:["從強調父母親權到視兒童少年為社會資產","從福利服務到兒童少年基本人權保障","從父母親權轉向學校干預","從個體服務轉向以家庭為中心的服務觀點"],answer:3},
  {q:"美國學者Nancy B. Webb(2003)提出在進行兒童生理心理社會評估時，所運用的三維評估是那三維？",options:["個人因素、家庭因素、學校因素","個人因素、家庭因素、社會因素","個人因素、情境因素、社會因素","個人因素、情境因素、支持系統因素"],answer:4},
  {q:"請問下列有關兒童福利服務的項目，何者不屬於現金給付的型態？",options:["保費補助","育兒津貼","安置服務","經濟補助"],answer:3},
  {q:"從事兒童保護的社會工作者，應了解兒童與家長通常需要不同的支持服務。下列那一個敘述是錯誤的？",options:["兒童需要獲得實質的幫助，他們喜歡能從各個角度了解兒童生活的社會工作者","父母重視目的、預期成果和公開透明的服務，因此社會工作者不能迴避與父母接觸","不管是父母還是孩子，他們都重視願意花時間傾聽、提供情感支持的社會工作者","為了保障兒童的安全，要避免讓安置中的兒童進行親子接觸，並協助雙方克服失落感"],answer:4},
  {q:"對於兒童及少年家庭的「支持性服務」之實施，下列敘述何者正確？",options:["以寄養或安置的服務方式來替代原生家庭的照顧功能","以提供安置兒童少年的心理治療","以托育服務來支持父母照顧之不足","以早期療育服務來協助家庭照顧發展遲緩兒童"],answer:4},
  {q:"社會工作開始關心犯罪矯治問題可追溯至19世紀末，Jane Addams倡導應將少年與成人犯罪分別處理，促使美國成立第一個少年法庭，位於何處？",options:["紐約","水牛城","芝加哥","洛杉磯"],answer:3},
  {q:"6歲的小真因在原生家庭沒有受到適當的養育與照顧，其所在的縣市主管機關經評估之後為小真辦理家庭寄養服務。該項服務屬於下列兒童及少年福利服務的那一種類別？",options:["支持性服務","補充性服務","替代性服務","保護性服務"],answer:3},
  {q:"依據Kadushin及Martin(1988)提出的「支持性服務」、「補充性服務」及「替代性服務」觀點，下列敘述何者錯誤？",options:["家庭經濟補助是屬於補充性服務","收養是屬於替代性服務","發展遲緩兒童社區療育服務是屬於支持性服務","托育服務是屬於替代性服務"],answer:4},
  {q:"關於1989年聯合國所通過的「兒童權利公約」，下列敘述何者錯誤？",options:["為世界各國保障兒童少年權利的共同準則","彰顯現今對於兒童少年權利保障的重視","因應兒童少年無能力的特質所發展的保護體系","以人性尊嚴為理念，將兒童少年視為獨立的個體"],answer:4},
  {q:"下列何者不是預防兒童虐待的適當方式？",options:["教導孩童順從父母不得反抗","鼓勵發現者即早通報","加強家長親職教育","協助家庭處理經濟壓力"],answer:1},
  {q:"下列那一項是關於兒少受虐的錯誤認知？",options:["兒少受虐現象存在於各種社經背景的家庭中","會虐待兒少者對所有人都會暴力相向","男孩也可能是性虐待的受害者","疏忽是兒少虐待的類型之一"],answer:2},
  {q:"下列何者不是幼兒時期的重要發展任務？",options:["能跑能跳","手能握物","絕不二過","簡單會話"],answer:3}
];

const app = document.getElementById('app');
let quizState = {
  quizStarted: false,
  quizFinished: false,
  totalQuestions: 0,
  current: 0,
  userAnswers: [],
  quizQuestions: [],
  quizOptions: [],
  timer: 0,
  timerInterval: null
};

function shuffle(array) {
  let currentIndex = array.length, randomIndex;
  while (currentIndex !== 0) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;
    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
  }
  return array;
}

function shuffleOptions(q) {
  let idxArr = Array.from({length: q.options.length}, (_, i) => i);
  shuffle(idxArr);
  return idxArr;
}

function renderHome() {
  quizState.quizStarted = false;
  quizState.quizFinished = false;
  app.innerHTML = `
    <h1>兒少社會工作理</h1>
    <h2>(從總題庫抽出50題)</h2>
    <div class="btn-group">
      <button onclick="startQuiz(5)">5題測驗</button>
      <button onclick="startQuiz(10)">10題測驗</button>
    </div>
  `;
}

window.startQuiz = function(num) {
  quizState.quizStarted = true;
  quizState.quizFinished = false;
  quizState.totalQuestions = num;
  quizState.current = 0;
  quizState.userAnswers = [];
  quizState.timer = 0;
  // 隨機抽題（不重複）
  let idxArr = Array.from({length: questions.length}, (_, i) => i);
  shuffle(idxArr);
  quizState.quizQuestions = idxArr.slice(0, num).map(i => questions[i]);
  quizState.quizOptions = quizState.quizQuestions.map(q => shuffleOptions(q));
  renderQuiz();
  if (quizState.timerInterval) clearInterval(quizState.timerInterval);
  quizState.timerInterval = setInterval(() => {
    quizState.timer++;
    if (quizState.quizStarted && !quizState.quizFinished) {
      document.getElementById('timer').innerText = formatTime(quizState.timer);
    }
  }, 1000);
}

function formatTime(sec) {
  let m = Math.floor(sec/60);
  let s = sec%60;
  return `${m}:${s.toString().padStart(2,'0')}`;
}

function renderQuiz() {
  const q = quizState.quizQuestions[quizState.current];
  const optOrder = quizState.quizOptions[quizState.current];
  const userAns = quizState.userAnswers[quizState.current];
  const progress = ((quizState.current) / quizState.totalQuestions) * 100;
  app.innerHTML = `
    <h1>兒少社會工作</h1>
    <h2>(從總題庫抽出50題)</h2>
    <div class="timer">時間：<span id="timer">${formatTime(quizState.timer)}</span></div>
    <div class="progress"><div class="progress-bar" style="width:${progress}%;"></div></div>
    <div class="question-card">
      <div class="question">${q.q}</div>
      <div class="options">
        ${optOrder.map((idx, i) => `
          <div class="option${userAns === i ? ' selected' : ''}" onclick="selectOption(${i})">
            <span style="font-weight:bold;margin-right:8px;">${String.fromCharCode(65+i)}.</span> ${q.options[idx]}
          </div>
        `).join('')}
      </div>
    </div>
    <div class="actions">
      <button onclick="prevQ()" ${quizState.current === 0 ? 'disabled' : ''}>上一題</button>
      <button onclick="nextQ()">${quizState.current === quizState.totalQuestions - 1 ? '繳交' : '下一題'}</button>
    </div>
  `;
}

window.selectOption = function(idx) {
  quizState.userAnswers[quizState.current] = idx;
  renderQuiz();
}

window.prevQ = function() {
  if (quizState.current > 0) {
    quizState.current--;
    renderQuiz();
  }
}

window.nextQ = function() {
  if (quizState.userAnswers[quizState.current] === undefined) {
    alert('請先選擇答案！');
    return;
  }
  if (quizState.current < quizState.totalQuestions - 1) {
    quizState.current++;
    renderQuiz();
  } else {
    finishQuiz();
  }
}

function finishQuiz() {
  quizState.quizFinished = true;
  quizState.quizStarted = false;
  clearInterval(quizState.timerInterval);
  let correct = 0;
  let detail = [];
  quizState.quizQuestions.forEach((q, i) => {
    const optOrder = quizState.quizOptions[i];
    const userIdx = quizState.userAnswers[i];
    const correctIdx = optOrder.indexOf(q.answer);
    if (userIdx === correctIdx) correct++;
    detail.push({
      q: q.q,
      options: optOrder.map(idx => q.options[idx]),
      user: userIdx,
      correct: correctIdx
    });
  });
  app.innerHTML = `
    <h1>兒少社會工作</h1>
    <h2>(從總題庫抽出50題)</h2>
    <div class="summary">
      <div class="score">得分：${correct} / ${quizState.totalQuestions}</div>
      <div>正確：<span style="color:#00b894;font-weight:bold;">${correct}</span>　錯誤：<span style="color:#d63031;font-weight:bold;">${quizState.totalQuestions - correct}</span></div>
      <div>作答時間：${formatTime(quizState.timer)}</div>
      <button style="margin-top:24px;" onclick="renderHome()">重新開始</button>
    </div>
    <div class="download-group">
      <button onclick="downloadPDF()">下載PDF</button>
      <button onclick="downloadCSV()">下載CSV</button>
    </div>
    <div class="review">
      <h3>答題詳解</h3>
      ${detail.map((d, i) => {
        const isCorrect = d.user === d.correct;
        return `
          <div class="review-item">
            <div class="review-q">${i+1}. ${d.q}</div>
            <div class="review-a">
              你的答案：<span class="${isCorrect ? 'review-correct' : 'review-wrong'}">${d.user !== undefined ? String.fromCharCode(65+d.user) + '. ' + d.options[d.user] : '未作答'}</span><br>
              正確答案：<span class="review-correct">${String.fromCharCode(65+d.correct)}. ${d.options[d.correct]}</span>
            </div>
          </div>
        `;
      }).join('')}
    </div>
  `;
}

window.downloadPDF = function() {
  const { jsPDF } = window.jspdf;
  let doc = new jsPDF();
  let y = 20;
  doc.setFontSize(18);
  doc.text('兒少社會工作 測驗詳解', 15, y);
  y += 10;
  doc.setFontSize(12);
  doc.text(`得分：${quizState.userAnswers.filter((ans, i) => {
    const optOrder = quizState.quizOptions[i];
    return ans === optOrder.indexOf(quizState.quizQuestions[i].answer);
  }).length} / ${quizState.totalQuestions}  時間：${formatTime(quizState.timer)}`, 15, y);
  y += 10;
  quizState.quizQuestions.forEach((q, i) => {
    const optOrder = quizState.quizOptions[i];
    const userIdx = quizState.userAnswers[i];
    const correctIdx = optOrder.indexOf(q.answer);
    doc.text(`${i+1}. ${q.q}`, 15, y);
    y += 8;
    optOrder.forEach((idx, j) => {
      let mark = '';
      if (j === correctIdx) mark = ' (正確)';
      if (j === userIdx) mark += ' (你的答案)';
      doc.text(`${String.fromCharCode(65+j)}. ${q.options[idx]}${mark}`, 20, y);
      y += 7;
      if (y > 270) { doc.addPage(); y = 20; }
    });
    y += 4;
    if (y > 270) { doc.addPage(); y = 20; }
  });
  doc.save('社會工作理論三_測驗詳解.pdf');
}

window.downloadCSV = function() {
  let csv = '題號,題目,你的答案,正確答案\n';
  quizState.quizQuestions.forEach((q, i) => {
    const optOrder = quizState.quizOptions[i];
    const userIdx = quizState.userAnswers[i];
    const correctIdx = optOrder.indexOf(q.answer);
    csv += `${i+1},"${q.q}","${userIdx !== undefined ? String.fromCharCode(65+userIdx)+'. '+q.options[optOrder[userIdx]] : '未作答'}","${String.fromCharCode(65+correctIdx)+'. '+q.options[optOrder[correctIdx]]}"\n`;
  });
  const blob = new Blob([csv], {type: 'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = '兒少社會工作_測驗詳解.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

renderHome();
  </script>
</body>
</html>
