import React, { useState } from 'react';
import { BookOpen, CheckSquare, ChevronRight, ChevronLeft, Info, Layout, HelpCircle, CheckCircle, XCircle, RefreshCw, ArrowDown, Brain, Database, ZoomIn, Globe } from 'lucide-react';

// ==========================================
// å…§å®¹è³‡æ–™åº« (Content Data)
// ==========================================
const PAGE_DATA = {
  title: "ç¤¾æœƒå·¥ä½œç ”ç©¶çš„å“²å­¸èˆ‡ç†è«–",
  subtitle: "ç ”ç©¶çš„è—åœ–èˆ‡åœ°åŸº",
  intro: "å¦‚æœèªªã€Œç ”ç©¶æ–¹æ³•ã€æ˜¯è“‹æˆ¿å­çš„å·¥å…·ï¼ˆå¦‚éšå­ã€é‹¸å­ï¼‰ï¼Œé‚£éº¼ã€Œå“²å­¸èˆ‡ç†è«–ã€å°±æ˜¯è—åœ–èˆ‡åœ°åŸºã€‚ä¸€å€‹ä¸äº†è§£å“²å­¸çš„ç ”ç©¶è€…ï¼Œå°±åƒæ‹¿è‘—å·¥å…·å»ä¸çŸ¥é“ç‚ºä½•è€Œè“‹çš„å·¥äººã€‚æœ¬ç« ç¯€å°‡å¸¶æ‚¨æ¢ç´¢ç ”ç©¶èƒŒå¾Œçš„ä¿¡å¿µç³»çµ±èˆ‡é‚è¼¯æ¶æ§‹ã€‚",
  
  // Tab 1: æ ¸å¿ƒé–±è®€ (Reading)
  sections: [
    {
      id: "intro",
      title: "ğŸ  å°è«–ï¼šç‚ºä½•éœ€è¦å“²å­¸ï¼Ÿ",
      content: `åœ¨ç¤¾æœƒå·¥ä½œç ”ç©¶ä¸­ï¼Œå“²å­¸èˆ‡ç†è«–æ‰®æ¼”è‘—é—œéµè§’è‰²ï¼š

1. **å“²å­¸å…¸ç¯„ (Paradigm)**ï¼šæ±ºå®šäº†æˆ‘å€‘çš„ã€Œä¸–ç•Œè§€ã€ã€‚å›ç­”äº†ã€Œä»€éº¼æ˜¯çœŸå¯¦ï¼Ÿã€ã€ã€Œæˆ‘å€‘å¦‚ä½•èªè­˜çœŸå¯¦ï¼Ÿã€ç­‰æ ¹æœ¬å•é¡Œã€‚
2. **ç†è«– (Theory)**ï¼šæä¾›äº†è§€å¯Ÿä¸–ç•Œçš„ã€Œé¡ç‰‡ã€ã€‚å¹«åŠ©æˆ‘å€‘çµ„ç¹”è§€å¯Ÿã€è§£é‡‹ç¾è±¡ä¸¦é æ¸¬æœªä¾†ã€‚`
    },
    {
      id: "paradigm",
      title: "ğŸŒ å››å¤§å“²å­¸å…¸ç¯„",
      content: `ç ”ç©¶è€…çœ‹å¾…ä¸–ç•Œçš„ä¿¡å¿µç³»çµ±ï¼Œç›´æ¥å½±éŸ¿ç ”ç©¶æ–¹æ³•çš„é¸æ“‡ï¼š

ğŸ”¹ **å¯¦è­‰ä¸»ç¾© (Positivism)**
ä¸–ç•Œè§€ï¼šå­˜åœ¨ä¸€å€‹å®¢è§€ã€ç¨ç«‹æ–¼äººçš„çœŸå¯¦ä¸–ç•Œã€‚
ç›®æ¨™ï¼šå°‹æ‰¾æ™®ä¸–çš„ã€Œå› æœæ³•å‰‡ã€ã€‚
æ–¹æ³•ï¼šé‡åŒ–ç ”ç©¶ã€å¯¦é©—æ³• (å¦‚ RCT)ã€‚

ğŸ”¹ **è©®é‡‹/å»ºæ§‹ä¸»ç¾© (Interpretivism)**
ä¸–ç•Œè§€ï¼šçœŸå¯¦æ˜¯ä¸»è§€å»ºæ§‹çš„ï¼Œæ˜¯é€éäº’å‹•è³¦äºˆæ„ç¾©çš„ã€‚
ç›®æ¨™ï¼šæ·±å…¥ã€Œç†è§£ã€äººå€‘çš„ä¸»è§€ç¶“é©—ã€‚
æ–¹æ³•ï¼šè³ªæ€§ç ”ç©¶ã€æ·±åº¦è¨ªè«‡ã€‚

ğŸ”¹ **æ‰¹åˆ¤å…¸ç¯„ (Critical Paradigm)**
ä¸–ç•Œè§€ï¼šä¸–ç•Œå……æ»¿æ¬ŠåŠ›é¬¥çˆ­èˆ‡å£“è¿«ã€‚
ç›®æ¨™ï¼šã€Œæ­éœ²ã€ä¸ç¾©çµæ§‹ï¼Œä¸¦ã€Œè³¦æ¬Šã€å¼±å‹¢ä»¥ä¿ƒæˆæ”¹è®Šã€‚
æ–¹æ³•ï¼šè¡Œå‹•ç ”ç©¶ã€æ‰¹åˆ¤è«–è¿°åˆ†æã€‚

ğŸ”¹ **å¯¦ç”¨ä¸»ç¾© (Pragmatism)**
ä¸–ç•Œè§€ï¼šä¸çˆ­è«–çµ•å°çœŸç†ï¼Œé—œæ³¨ã€Œä»€éº¼æ˜¯æœ‰æ•ˆçš„ã€ã€‚
ç›®æ¨™ï¼šè§£æ±ºå¯¦éš›å•é¡Œã€‚
æ–¹æ³•ï¼šæ··åˆç ”ç©¶æ³• (Mixed Methods)ã€‚`
    },
    {
      id: "explanation",
      title: "ğŸ¯ è§£é‡‹çš„å…©ç¨®é¡å‹",
      content: `ç ”ç©¶çš„ç›®æ¨™æ˜¯è§£é‡‹ï¼Œä½†æœ‰æ·±åº¦èˆ‡å»£åº¦ä¹‹åˆ†ï¼š

ğŸ”¸ **å€‹æ®Šå¼è§£é‡‹ (Idiographic)**
ç›®æ¨™ï¼šè¿½æ±‚ã€Œå®Œæ•´ã€èˆ‡ã€Œæ·±å…¥ã€åœ°ç†è§£ã€Œå–®ä¸€ã€å€‹æ¡ˆçš„æ‰€æœ‰æˆå› ã€‚
ç¯„ä¾‹ï¼šæ·±å…¥æ¢è¨ã€Œå°æ˜ã€ç‚ºä½•ä¸­è¼Ÿçš„æ‰€æœ‰ç¨ç‰¹æ•…äº‹ï¼ˆå®¶åº­ã€åŒå„•ã€å¿ƒç†...ï¼‰ã€‚
é©ç”¨ï¼šè³ªæ€§ç ”ç©¶ã€å€‹æ¡ˆç ”ç©¶ã€‚

ğŸ”¸ **å¾‹å‰‡å¼è§£é‡‹ (Nomothetic)**
ç›®æ¨™ï¼šè¿½æ±‚ã€Œç°¡æ½”ã€èˆ‡ã€Œæ¦‚åŒ–ã€ï¼Œæ‰¾å‡ºè§£é‡‹ã€Œå¤šæ•¸ã€æƒ…æ³çš„å°‘æ•¸é—œéµè®Šé …ã€‚
ç¯„ä¾‹ï¼šåˆ†æ500ä½ä¸­è¼Ÿç”Ÿï¼Œç™¼ç¾ã€Œå®¶åº­æ”¯æŒä½ã€æ˜¯æœ€å¤§çš„å…±åŒé æ¸¬å› å­ã€‚
é©ç”¨ï¼šé‡åŒ–ç ”ç©¶ã€çµ±è¨ˆåˆ†æã€‚`
    }
  ],

  // Tab 2: ç†è«–æ¶æ§‹èˆ‡é‚è¼¯ (Visuals)
  // é€™è£¡æˆ‘å€‘å°‡åŸæœ¬çš„ steps æ”¹ç‚ºå…©ç¨®äº’å‹•æ¨¡å¼
  logicModels: [
    {
      id: "structure",
      title: "ç†è«–çš„æ§‹æˆéšæ¢¯",
      description: "ç†è«–ä¸æ˜¯ä¸€å¡Šéµæ¿ï¼Œè€Œæ˜¯ç”±æŠ½è±¡åˆ°å…·é«”çš„ä¸€ç³»åˆ—å…ƒä»¶çµ„æˆçš„é‚è¼¯é«”ç³»ã€‚",
      items: [
        {
          title: "ç†è«– (Theory)",
          desc: "ä¸€å¥—æœ‰ç³»çµ±çš„å‘½é¡Œï¼Œç”¨ä»¥è§£é‡‹ç‰¹å®šç¾è±¡ã€‚æ˜¯æŠ½è±¡çš„è§£é‡‹é«”ç³»ã€‚",
          example: "ä¾‹å¦‚ï¼šç¤¾æœƒé€£å¸¶ç†è«– (Social Bond Theory)"
        },
        {
          title: "æ¦‚å¿µ (Concepts)",
          desc: "ç†è«–çš„åŸºçŸ³ï¼ŒæŠ½è±¡çš„æ¨™ç±¤ã€‚è¤‡é›œæ¦‚å¿µå¸¸åŒ…å«å¤šå€‹ç¶­åº¦ã€‚",
          example: "ä¾‹å¦‚ï¼šä¾é™„ (Attachment)ã€åå·®è¡Œç‚º"
        },
        {
          title: "å‘½é¡Œ (Propositions)",
          desc: "é™³è¿°ã€Œæ¦‚å¿µã€ä¹‹é–“æŠ½è±¡é—œä¿‚çš„èªå¥ã€‚",
          example: "ä¾‹å¦‚ï¼šå€‹äººçš„ã€Œä¾é™„ã€è¶Šå¼·ï¼Œå…¶ã€Œåå·®è¡Œç‚ºã€è¶Šå°‘ã€‚"
        },
        {
          title: "å‡è¨­ (Hypothesis)",
          desc: "å°‡å‘½é¡Œè½‰åŒ–ç‚ºã€Œå¯æ¸¬é‡ã€çš„å…·é«”é™³è¿°ï¼Œç”¨æ–¼å¯¦è­‰æª¢é©—ã€‚",
          example: "ä¾‹å¦‚ï¼šé’å°‘å¹´ã€Œå°çˆ¶æ¯çš„è¦ªå¯†æ„Ÿè©•åˆ†ã€è¶Šé«˜ï¼Œã€Œé€ƒå­¸æ¬¡æ•¸ã€è¶Šå°‘ã€‚"
        }
      ]
    },
    {
      id: "wheel",
      title: "ç§‘å­¸ä¹‹è¼ªï¼šæ­¸ç´èˆ‡æ¼”ç¹¹",
      description: "ç§‘å­¸ç ”ç©¶æ˜¯ä¸€å€‹ä¸æ–·å¾ªç’°çš„éç¨‹ï¼Œé€£çµäº†ç†è«–èˆ‡è§€å¯Ÿã€‚",
      items: [
        {
          title: "æ­¸ç´æ³• (Induction)",
          sub: "ç”±ä¸‹è€Œä¸Š (Bottom-up)",
          desc: "å¾ã€Œå…·é«”è§€å¯Ÿã€å‡ºç™¼ â” å°‹æ‰¾æ¨¡å¼ â” å»ºç«‹ã€Œæš«æ™‚æ€§ç†è«–ã€ã€‚",
          use: "å¸¸ç”¨æ–¼è³ªæ€§ã€æ¢ç´¢æ€§ç ”ç©¶ã€‚"
        },
        {
          title: "æ¼”ç¹¹æ³• (Deduction)",
          sub: "ç”±ä¸Šè€Œä¸‹ (Top-down)",
          desc: "å¾ã€Œæ—¢æœ‰ç†è«–ã€å‡ºç™¼ â” æ¨å°å‡è¨­ â” è’é›†è³‡æ–™ã€Œé©—è­‰ã€ã€‚",
          use: "å¸¸ç”¨æ–¼é‡åŒ–ã€é©—è­‰æ€§ç ”ç©¶ã€‚"
        }
      ]
    }
  ],

  // Tab 3: éš¨å ‚æ¸¬é©— (Quizzes)
  quizzes: [
    {
      question: "ä¸€ä½ç ”ç©¶è€…èˆ‡ç¤¾å€å±…æ°‘ã€Œå…±åŒã€æ¢è¨å•é¡Œï¼Œä¸¦è‡´åŠ›æ–¼æ‰¾å‡ºæ–¹æ¡ˆä»¥ã€Œçˆ­å–æ¬Šç›Šã€ã€‚é€™æœ€ç¬¦åˆå“ªä¸€ç¨®å“²å­¸å…¸ç¯„ï¼Ÿ",
      options: [
        "å¯¦è­‰ä¸»ç¾© (Positivism)",
        "è©®é‡‹ä¸»ç¾© (Interpretivism)",
        "æ‰¹åˆ¤å…¸ç¯„ (Critical Paradigm)",
        "å¯¦ç”¨ä¸»ç¾© (Pragmatism)"
      ],
      correctIndex: 2,
      explanation: "ç­”å°äº†ï¼æ‰¹åˆ¤å…¸ç¯„çš„æ ¸å¿ƒç›®æ¨™æ­£æ˜¯æ­éœ²ä¸ç¾©ã€è³¦æ¬Šå¼±å‹¢ï¼Œä¸¦é€éè¡Œå‹•ï¼ˆå¦‚è¡Œå‹•ç ”ç©¶ï¼‰ä¾†ä¿ƒæˆç¤¾æœƒæ”¹è®Šã€‚"
    },
    {
      question: "ç ”ç©¶è€…æå‡ºï¼šã€Œã€ç¤¾æœƒæ”¯æŒã€è¶Šé«˜çš„äººï¼Œå…¶ã€æ†‚é¬±ç¨‹åº¦ã€è¶Šä½ã€‚ã€é€™å€‹é™³è¿°å±¬æ–¼ç†è«–å»ºæ§‹ä¸­çš„å“ªä¸€å±¤æ¬¡ï¼Ÿ",
      options: [
        "ç†è«– (Theory)",
        "æ¦‚å¿µ (Concept)",
        "å‘½é¡Œ (Proposition)",
        "å‡è¨­ (Hypothesis)"
      ],
      correctIndex: 2,
      explanation: "æ­£ç¢ºï¼é€™æ˜¯é™³è¿°å…©å€‹æŠ½è±¡ã€Œæ¦‚å¿µã€ï¼ˆç¤¾æœƒæ”¯æŒã€æ†‚é¬±ï¼‰ä¹‹é–“é—œä¿‚çš„ã€Œå‘½é¡Œã€ã€‚å¦‚æœè½‰åŒ–ç‚ºå…·é«”é‡è¡¨åˆ†æ•¸ï¼Œæ‰æœƒè®Šæˆå‡è¨­ã€‚"
    },
    {
      question: "ç¤¾å·¥è¨ªè«‡å—æš´å©¦å¥³å¾Œï¼Œç™¼ç¾ã€Œç¶“æ¿Ÿä¾è³´ã€æ˜¯å…±åŒä¸»å› ï¼Œæ–¼æ˜¯ã€Œç™¼å±•ã€å‡ºä¸€å€‹é—œæ–¼ç¶“æ¿Ÿè³¦æ¬Šçš„åˆæ­¥ç†è«–ã€‚é€™æ˜¯ä½¿ç”¨å“ªç¨®é‚è¼¯ï¼Ÿ",
      options: [
        "æ­¸ç´æ³• (Induction)",
        "æ¼”ç¹¹æ³• (Deduction)",
        "å€‹æ®Šå¼ (Idiographic)",
        "å¾‹å‰‡å¼ (Nomothetic)"
      ],
      correctIndex: 0,
      explanation: "æ²’éŒ¯ï¼å¾å…·é«”è§€å¯Ÿï¼ˆè¨ªè«‡ï¼‰å‡ºç™¼ï¼Œæ­¸ç´å‡ºæ¨¡å¼ä¸¦å»ºç«‹ç†è«–ï¼Œé€™æ˜¯ã€Œç”±ä¸‹è€Œä¸Šã€çš„æ­¸ç´æ³•ã€‚"
    },
    {
      question: "ç¤¾å·¥æƒ³äº†è§£ã€ŒAç¤¾å€ã€åœ¨é¢¨ç½å¾Œç‚ºä½•å¾©åŸç‰¹åˆ¥å¿«ï¼Œå¥¹æ·±å…¥åˆ†æè©²ç¤¾å€çš„æ­·å²ã€æ–‡åŒ–èˆ‡æ‰€æœ‰ç¨ç‰¹å› ç´ ã€‚å¥¹è¿½æ±‚çš„æ˜¯å“ªç¨®è§£é‡‹ï¼Ÿ",
      options: [
        "å€‹æ®Šå¼è§£é‡‹ (Idiographic)",
        "å¾‹å‰‡å¼è§£é‡‹ (Nomothetic)",
        "æ¼”ç¹¹æ³• (Deduction)",
        "å¯¦è­‰ä¸»ç¾© (Positivism)"
      ],
      correctIndex: 0,
      explanation: "ç­”å°äº†ï¼å€‹æ®Šå¼è§£é‡‹è©¦åœ–ã€Œå®Œæ•´ã€ä¸”ã€Œæ·±å…¥ã€åœ°ç†è§£ã€Œå–®ä¸€ã€å€‹æ¡ˆçš„æ‰€æœ‰ç¨ç‰¹è„ˆçµ¡ã€‚"
    }
  ],

  // Tab 4: è‡ªæˆ‘æª¢æ ¸ (Checklist)
  checklist: [
    "æˆ‘èƒ½å€åˆ†å››å¤§å“²å­¸å…¸ç¯„ï¼ˆå¯¦è­‰ã€è©®é‡‹ã€æ‰¹åˆ¤ã€å¯¦ç”¨ï¼‰çš„æ ¸å¿ƒå·®ç•°",
    "æˆ‘ç†è§£ç†è«–å»ºæ§‹çš„å››å€‹å±¤æ¬¡ï¼ˆç†è«– â” æ¦‚å¿µ â” å‘½é¡Œ â” å‡è¨­ï¼‰",
    "æˆ‘èƒ½åˆ†è¾¨æ­¸ç´æ³•ï¼ˆè§€å¯Ÿâ”ç†è«–ï¼‰èˆ‡æ¼”ç¹¹æ³•ï¼ˆç†è«–â”è§€å¯Ÿï¼‰çš„ä¸åŒ",
    "æˆ‘èƒ½èˆ‰ä¾‹èªªæ˜å€‹æ®Šå¼è§£é‡‹èˆ‡å¾‹å‰‡å¼è§£é‡‹çš„å·®åˆ¥"
  ]
};

// ==========================================
// æ‡‰ç”¨ç¨‹å¼é‚è¼¯ (Application Logic)
// ==========================================

export default function InteractivePage() {
  const [activeTab, setActiveTab] = useState('read');
  const [logicView, setLogicView] = useState('structure'); // structure or wheel
  const [quizState, setQuizState] = useState({});
  const [checkedItems, setCheckedItems] = useState({});
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [showConfetti, setShowConfetti] = useState(false);

  // Checklist Logic
  const toggleCheck = (index) => {
    const nextState = { ...checkedItems, [index]: !checkedItems[index] };
    setCheckedItems(nextState);
    if (PAGE_DATA.checklist.every((_, i) => nextState[i])) {
      setShowConfetti(true);
      setTimeout(() => setShowConfetti(false), 3000);
    }
  };

  // Quiz Logic
  const handleQuizAnswer = (qIndex, optionIndex) => {
    setQuizState(prev => ({
      ...prev,
      [qIndex]: {
        selected: optionIndex,
        isCorrect: optionIndex === PAGE_DATA.quizzes[qIndex].correctIndex
      }
    }));
  };

  return (
    <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-indigo-100 selection:text-indigo-900">
      {/* Navigation */}
      <nav className="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-slate-200 shadow-sm">
        <div className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between h-16 items-center">
            <div className="flex items-center gap-2">
              <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold shadow-lg shadow-indigo-200">
                P&T
              </div>
              <span className="font-bold text-xl tracking-tight text-slate-900 hidden sm:block">Philosophy & Theory</span>
              <span className="font-bold text-xl tracking-tight text-slate-900 sm:hidden">Phil. & Theory</span>
            </div>
            
            {/* Desktop Tabs */}
            <div className="hidden md:flex space-x-1 bg-slate-100 p-1 rounded-xl">
              {[
                { id: 'read', label: 'æ ¸å¿ƒé–±è®€', icon: BookOpen },
                { id: 'visuals', label: 'é‚è¼¯åœ–è§£', icon: Layout },
                { id: 'quiz', label: 'éš¨å ‚æ¸¬é©—', icon: HelpCircle },
                { id: 'check', label: 'è‡ªæˆ‘æª¢æ ¸', icon: CheckSquare }
              ].map((tab) => (
                <button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${
                    activeTab === tab.id
                      ? 'bg-white text-indigo-600 shadow-sm ring-1 ring-black/5'
                      : 'text-slate-500 hover:text-slate-700 hover:bg-slate-200/50'
                  }`}
                >
                  <tab.icon size={16} />
                  {tab.label}
                </button>
              ))}
            </div>

            {/* Mobile Menu Toggle */}
            <div className="md:hidden">
              <button onClick={() => setIsMenuOpen(!isMenuOpen)} className="p-2 text-slate-600 hover:bg-slate-100 rounded-lg">
                {isMenuOpen ? <X size={24} /> : <Layout size={24} />}
              </button>
            </div>
          </div>
        </div>

        {/* Mobile Menu */}
        {isMenuOpen && (
          <div className="md:hidden bg-white border-b border-slate-200 px-4 py-4 space-y-2 shadow-lg">
            {[
              { id: 'read', label: 'æ ¸å¿ƒé–±è®€', icon: BookOpen },
              { id: 'visuals', label: 'é‚è¼¯åœ–è§£', icon: Layout },
              { id: 'quiz', label: 'éš¨å ‚æ¸¬é©—', icon: HelpCircle },
              { id: 'check', label: 'è‡ªæˆ‘æª¢æ ¸', icon: CheckSquare }
            ].map((tab) => (
              <button
                key={tab.id}
                onClick={() => { setActiveTab(tab.id); setIsMenuOpen(false); }}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium ${
                  activeTab === tab.id ? 'bg-indigo-50 text-indigo-600' : 'text-slate-600 hover:bg-slate-50'
                }`}
              >
                <tab.icon size={18} />
                {tab.label}
              </button>
            ))}
          </div>
        )}
      </nav>

      <main className="max-w-3xl mx-auto px-4 sm:px-6 py-8 sm:py-12">
        {/* Header */}
        <div className="mb-10 text-center animate-fade-in">
          <span className="inline-block px-3 py-1 mb-3 text-xs font-semibold tracking-wider text-indigo-600 uppercase bg-indigo-50 rounded-full border border-indigo-100">
            {PAGE_DATA.subtitle}
          </span>
          <h1 className="text-2xl sm:text-4xl font-extrabold text-slate-900 mb-4 leading-tight">
            {PAGE_DATA.title}
          </h1>
          <p className="text-base sm:text-lg text-slate-600 max-w-2xl mx-auto leading-relaxed">
            {PAGE_DATA.intro}
          </p>
        </div>

        <div className="min-h-[400px]">
          
          {/* TAB 1: READ */}
          {activeTab === 'read' && (
            <div className="space-y-8 animate-slide-up">
              {PAGE_DATA.sections.map((section, idx) => (
                <div key={idx} className="bg-white rounded-2xl p-6 sm:p-8 shadow-sm border border-slate-100">
                  <div className="flex items-center gap-3 mb-6 border-b border-slate-100 pb-4">
                    <h2 className="text-xl font-bold text-slate-800">{section.title}</h2>
                  </div>
                  <div className="prose prose-slate prose-indigo max-w-none text-slate-600 leading-relaxed whitespace-pre-line">
                    {section.content}
                  </div>
                </div>
              ))}
              <div className="flex justify-center pt-4">
                <button 
                  onClick={() => setActiveTab('visuals')}
                  className="flex items-center gap-2 bg-indigo-600 text-white px-6 py-3 rounded-full font-medium shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-colors"
                >
                  ä¸‹ä¸€æ­¥ï¼šåœ–è§£é‚è¼¯ <ChevronRight size={18} />
                </button>
              </div>
            </div>
          )}

          {/* TAB 2: VISUALS (Theory & Logic) */}
          {activeTab === 'visuals' && (
            <div className="animate-slide-up max-w-2xl mx-auto">
              
              {/* Sub-navigation for visuals */}
              <div className="flex justify-center mb-8 space-x-4">
                <button
                  onClick={() => setLogicView('structure')}
                  className={`px-4 py-2 rounded-full text-sm font-bold transition-all ${
                    logicView === 'structure' 
                      ? 'bg-indigo-600 text-white shadow-md' 
                      : 'bg-white text-slate-500 border border-slate-200 hover:bg-slate-50'
                  }`}
                >
                  ç†è«–éšæ¢¯
                </button>
                <button
                  onClick={() => setLogicView('wheel')}
                  className={`px-4 py-2 rounded-full text-sm font-bold transition-all ${
                    logicView === 'wheel' 
                      ? 'bg-indigo-600 text-white shadow-md' 
                      : 'bg-white text-slate-500 border border-slate-200 hover:bg-slate-50'
                  }`}
                >
                  ç§‘å­¸ä¹‹è¼ª
                </button>
              </div>

              {/* View 1: Theory Structure (Ladder) */}
              {logicView === 'structure' && (
                <div className="space-y-4">
                  <div className="bg-blue-50 p-4 rounded-xl border border-blue-100 mb-4">
                    <h3 className="font-bold text-blue-800 mb-2 flex items-center gap-2">
                      <ArrowDown size={20} /> å¾æŠ½è±¡åˆ°å…·é«”
                    </h3>
                    <p className="text-sm text-blue-600">
                      ç†è«–å»ºæ§‹æ˜¯ä¸€å€‹ã€Œæ“ä½œåŒ–ã€çš„éç¨‹ï¼Œæˆ‘å€‘å¿…é ˆå°‡æŠ½è±¡çš„æƒ³æ³•ä¸€æ­¥æ­¥è½‰åŒ–ç‚ºå¯ä»¥æ¸¬é‡çš„è®Šé …ã€‚
                    </p>
                  </div>

                  {PAGE_DATA.logicModels[0].items.map((item, idx) => (
                    <div key={idx} className="relative">
                      {idx !== 0 && (
                        <div className="absolute left-8 -top-4 h-4 w-0.5 bg-slate-300 z-0"></div>
                      )}
                      <div className="bg-white p-6 rounded-xl shadow-sm border-l-4 border-indigo-500 border-y border-r border-slate-100 relative z-10 hover:shadow-md transition-all">
                        <div className="flex justify-between items-start">
                          <div>
                            <h4 className="text-lg font-bold text-slate-800 mb-1">{item.title}</h4>
                            <p className="text-slate-600 text-sm mb-3">{item.desc}</p>
                            <div className="bg-slate-50 text-slate-500 text-xs p-2 rounded border border-slate-100 font-medium">
                              {item.example}
                            </div>
                          </div>
                          <div className="bg-indigo-50 text-indigo-600 font-bold text-xl w-8 h-8 rounded-full flex items-center justify-center shrink-0">
                            {idx + 1}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              )}

              {/* View 2: Wheel of Science (Induction/Deduction) */}
              {logicView === 'wheel' && (
                <div className="space-y-6">
                   <div className="bg-purple-50 p-4 rounded-xl border border-purple-100 mb-4">
                    <h3 className="font-bold text-purple-800 mb-2 flex items-center gap-2">
                      <RefreshCw size={20} /> å¾ªç’°çš„é‚è¼¯
                    </h3>
                    <p className="text-sm text-purple-600">
                      ç ”ç©¶ä¸ä¸€å®šè¦å¾ç†è«–é–‹å§‹ã€‚ä½ å¯ä»¥å¾è§€å¯Ÿé–‹å§‹ï¼ˆæ­¸ç´ï¼‰ï¼Œä¹Ÿå¯ä»¥å¾ç†è«–é–‹å§‹ï¼ˆæ¼”ç¹¹ï¼‰ã€‚å…©è€…ç›¸è¼”ç›¸æˆã€‚
                    </p>
                  </div>

                  <div className="grid gap-6">
                    {/* Induction Card */}
                    <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm hover:border-purple-300 transition-all group">
                      <div className="flex items-center gap-3 mb-4">
                        <div className="bg-purple-100 p-2 rounded-lg text-purple-600 group-hover:scale-110 transition-transform">
                          <ZoomIn size={24} />
                        </div>
                        <div>
                          <h4 className="font-bold text-lg text-slate-800">{PAGE_DATA.logicModels[1].items[0].title}</h4>
                          <span className="text-xs font-bold text-purple-600 uppercase tracking-wider">{PAGE_DATA.logicModels[1].items[0].sub}</span>
                        </div>
                      </div>
                      <p className="text-slate-600 mb-4 leading-relaxed">
                        {PAGE_DATA.logicModels[1].items[0].desc}
                      </p>
                      <div className="text-sm text-slate-400 bg-slate-50 p-3 rounded-lg">
                        ğŸ’¡ {PAGE_DATA.logicModels[1].items[0].use}
                      </div>
                    </div>

                    {/* Deduction Card */}
                    <div className="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm hover:border-teal-300 transition-all group">
                      <div className="flex items-center gap-3 mb-4">
                        <div className="bg-teal-100 p-2 rounded-lg text-teal-600 group-hover:scale-110 transition-transform">
                          <Brain size={24} />
                        </div>
                        <div>
                          <h4 className="font-bold text-lg text-slate-800">{PAGE_DATA.logicModels[1].items[1].title}</h4>
                          <span className="text-xs font-bold text-teal-600 uppercase tracking-wider">{PAGE_DATA.logicModels[1].items[1].sub}</span>
                        </div>
                      </div>
                      <p className="text-slate-600 mb-4 leading-relaxed">
                        {PAGE_DATA.logicModels[1].items[1].desc}
                      </p>
                      <div className="text-sm text-slate-400 bg-slate-50 p-3 rounded-lg">
                        ğŸ’¡ {PAGE_DATA.logicModels[1].items[1].use}
                      </div>
                    </div>
                  </div>
                  
                  <div className="text-center pt-4">
                     <button 
                      onClick={() => setActiveTab('quiz')}
                      className="text-indigo-600 font-medium hover:text-indigo-800 flex items-center justify-center gap-2 mx-auto"
                    >
                      ç†è§£äº†å—ï¼Ÿä¾†åšæ¸¬é©—å§ <ChevronRight size={16} />
                    </button>
                  </div>
                </div>
              )}
            </div>
          )}

          {/* TAB 3: QUIZ */}
          {activeTab === 'quiz' && (
            <div className="animate-slide-up max-w-2xl mx-auto space-y-8">
              <div className="bg-indigo-50 rounded-xl p-6 border border-indigo-100 mb-6 flex gap-4">
                <div className="bg-indigo-100 p-3 rounded-full h-fit">
                  <HelpCircle className="text-indigo-600 w-6 h-6" />
                </div>
                <div>
                  <h3 className="font-bold text-indigo-900 text-lg">éš¨å ‚æ¸¬é©—</h3>
                  <p className="text-indigo-700 mt-1">è«‹æ ¹æ“šå‰é¢å­¸åˆ°çš„è§€å¿µï¼Œå›ç­”ä»¥ä¸‹å•é¡Œã€‚</p>
                </div>
              </div>

              {PAGE_DATA.quizzes.map((quiz, qIndex) => {
                const state = quizState[qIndex];
                const isAnswered = state !== undefined;
                
                return (
                  <div key={qIndex} className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div className="p-6 border-b border-slate-100 bg-slate-50/50">
                      <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">Question {qIndex + 1}</span>
                      <h3 className="text-lg font-semibold text-slate-800 mt-2 leading-relaxed">{quiz.question}</h3>
                    </div>
                    <div className="p-4 space-y-3">
                      {quiz.options.map((option, oIndex) => {
                        let btnClass = "w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex justify-between items-center ";
                        
                        if (!isAnswered) {
                          btnClass += "border-slate-100 hover:border-indigo-200 hover:bg-indigo-50 text-slate-600";
                        } else {
                          if (oIndex === quiz.correctIndex) {
                            btnClass += "border-green-500 bg-green-50 text-green-800 font-medium";
                          } else if (state.selected === oIndex && !state.isCorrect) {
                            btnClass += "border-red-300 bg-red-50 text-red-800 opacity-70";
                          } else {
                            btnClass += "border-transparent text-slate-400 opacity-50 cursor-default";
                          }
                        }

                        return (
                          <button
                            key={oIndex}
                            onClick={() => !isAnswered && handleQuizAnswer(qIndex, oIndex)}
                            disabled={isAnswered}
                            className={btnClass}
                          >
                            <span>{option}</span>
                            {isAnswered && oIndex === quiz.correctIndex && <CheckCircle className="text-green-600" size={20} />}
                            {isAnswered && state.selected === oIndex && !state.isCorrect && <XCircle className="text-red-500" size={20} />}
                          </button>
                        );
                      })}
                    </div>
                    
                    {isAnswered && (
                      <div className={`p-5 mx-4 mb-4 rounded-xl text-sm ${state.isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                        <p className="font-bold mb-1">{state.isCorrect ? 'ğŸ‰ ç­”å°äº†ï¼' : 'ğŸ’¡ å†æƒ³ä¸€ä¸‹...'}</p>
                        <p>{quiz.explanation}</p>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          )}

          {/* TAB 4: CHECKLIST */}
          {activeTab === 'check' && (
            <div className="animate-slide-up max-w-xl mx-auto">
              <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                <div className="p-6 bg-gradient-to-r from-indigo-50 to-white border-b border-slate-100">
                  <h2 className="text-xl font-bold text-slate-800 flex items-center gap-2">
                    <CheckSquare className="text-indigo-600" />
                    å­¸ç¿’æˆæ•ˆæª¢æ ¸
                  </h2>
                  <p className="text-slate-500 text-sm mt-1">
                    å®Œæˆæ‰€æœ‰å­¸ç¿’å¾Œï¼Œè«‹ç¢ºèªæ‚¨å·²æŒæ¡ä»¥ä¸‹é‡é»ã€‚
                  </p>
                </div>
                
                <div className="divide-y divide-slate-100">
                  {PAGE_DATA.checklist.map((item, idx) => (
                    <label 
                      key={idx} 
                      className={`flex items-start gap-4 p-5 cursor-pointer hover:bg-slate-50 transition-colors ${
                        checkedItems[idx] ? 'bg-indigo-50/30' : ''
                      }`}
                    >
                      <div className="relative flex items-center mt-0.5">
                        <input
                          type="checkbox"
                          className="peer h-5 w-5 cursor-pointer appearance-none rounded-md border-2 border-slate-300 transition-all checked:border-indigo-500 checked:bg-indigo-500 hover:border-indigo-400"
                          checked={!!checkedItems[idx]}
                          onChange={() => toggleCheck(idx)}
                        />
                        <div className="pointer-events-none absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-white opacity-0 peer-checked:opacity-100">
                          <svg xmlns="http://www.w3.org/2000/svg" className="h-3.5 w-3.5" viewBox="0 0 20 20" fill="currentColor">
                            <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                          </svg>
                        </div>
                      </div>
                      <span className={`text-base transition-all ${
                        checkedItems[idx] ? 'text-slate-400 line-through' : 'text-slate-700'
                      }`}>
                        {item}
                      </span>
                    </label>
                  ))}
                </div>
                
                {showConfetti && (
                  <div className="p-4 bg-green-100 text-green-800 text-center font-medium animate-pulse">
                    ğŸ‰ æ­å–œï¼æ‚¨å·²å®Œæˆæœ¬ç« ç¯€çš„å­¸ç¿’ï¼
                  </div>
                )}
              </div>
            </div>
          )}

        </div>
      </main>

      <footer className="border-t border-slate-200 bg-white mt-20 py-8">
        <div className="max-w-5xl mx-auto px-4 text-center text-slate-400 text-sm">
          <p>Â© ç¤¾æœƒå·¥ä½œç ”ç©¶æ³• - äº’å‹•è¬›ç¾©</p>
        </div>
      </footer>

      <style>{`
        @keyframes slide-up {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-slide-up {
          animation: slide-up 0.4s ease-out forwards;
        }
        .animate-fade-in {
          animation: fade-in 0.6s ease-out forwards;
        }
      `}</style>
    </div>
  );
}
