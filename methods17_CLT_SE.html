<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Central Limit Theorem & Standard Error Interactive</title>
  
  <!-- 1. è¼‰å…¥ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- 2. è¼‰å…¥ React ç›¸é—œ (æ ¸å¿ƒ) -->
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  
  <!-- 3. è¼‰å…¥ Babel (JSX ç·¨è­¯å™¨) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .range-slider::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 20px; height: 20px;
      border-radius: 50%; background: #8b5cf6; cursor: pointer;
    }
    /* ç°¡å–®çš„æ·¡å…¥å‹•ç•« */
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    // --- ç°¡æ˜“åœ–ç¤ºçµ„ä»¶ ---
    const Icons = {
      BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
      Activity: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>,
      HelpCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>,
      CheckCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
      XCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>,
      ArrowRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      RefreshCw: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>,
      Layers: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>
    };

    // --- æ•¸å­¸èˆ‡éš¨æ©Ÿç”¢ç”Ÿå™¨ ---
    const Random = {
      // å¸¸æ…‹åˆ†ä½ˆ (Box-Muller)
      normal: (mean, sd) => {
        let u = 0, v = 0;
        while(u === 0) u = Math.random();
        while(v === 0) v = Math.random();
        let z = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
        return mean + z * sd;
      },
      // å‡å‹»åˆ†ä½ˆ
      uniform: (min, max) => {
        return Math.random() * (max - min) + min;
      },
      // åæ…‹åˆ†ä½ˆ (Exponential-like)
      skewed: (min, max) => {
        // ç°¡å–®æ¨¡æ“¬å³åï¼šéš¨æ©Ÿæ•¸å–å¹³æ–¹æœƒèšé›†åœ¨ 0 é™„è¿‘ï¼Œåè½‰å‰‡èšé›†åœ¨ 1 é™„è¿‘
        // é€™è£¡ç”¨ Beta åˆ†ä½ˆçš„ç°¡åŒ–ç‰ˆæˆ–æŒ‡æ•¸åˆ†ä½ˆ
        // è®“å¤§éƒ¨åˆ†æ•¸æ“šé›†ä¸­åœ¨å·¦å´ (å³å)
        let r = Math.random();
        r = 1 - Math.pow(1 - r, 3); // åå‘å°æ•¸å€¼
        return r * (max - min) + min;
      }
    };

    // --- SVG ç›´æ–¹åœ–çµ„ä»¶ ---
    const Histogram = ({ data, range, color, label, meanLine }) => {
      const binCount = 40;
      const min = range[0];
      const max = range[1];
      const width = max - min;
      const binSize = width / binCount;
      
      // è¨ˆç®— Bins
      const bins = new Array(binCount).fill(0);
      data.forEach(v => {
        let binIdx = Math.floor((v - min) / binSize);
        if (binIdx >= 0 && binIdx < binCount) {
          bins[binIdx]++;
        }
      });

      const maxCount = Math.max(...bins, 1); // é¿å…é™¤ä»¥ 0

      return (
        <div className="w-full h-40 relative border-b border-slate-300 mt-2">
          {/* Bars */}
          <div className="absolute inset-0 flex items-end">
            {bins.map((count, i) => (
              <div 
                key={i}
                className="flex-1 mx-[1px] transition-all duration-500 ease-out"
                style={{
                  height: `${(count / maxCount) * 100}%`,
                  backgroundColor: color,
                  opacity: 0.7
                }}
              ></div>
            ))}
          </div>
          
          {/* Mean Line */}
          {meanLine !== undefined && (
            <div 
              className="absolute top-0 bottom-0 w-0.5 bg-red-500 z-10 shadow"
              style={{ 
                left: `${((meanLine - min) / width) * 100}%`,
                transition: 'left 0.3s ease-out'
              }}
            >
              <div className="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-bold text-red-500 bg-white px-1 rounded shadow-sm border border-red-100 whitespace-nowrap">
                Î¼ = {meanLine.toFixed(1)}
              </div>
            </div>
          )}

          {/* Label */}
          <div className="absolute top-2 right-2 text-xs font-bold text-slate-400 uppercase bg-white/80 px-2 py-1 rounded">
            {label}
          </div>
        </div>
      );
    };

    // --- è³‡æ–™å…§å®¹ ---
    const PAGE_DATA = {
      title: "ä¸­å¤®æ¥µé™å®šç†èˆ‡æ¨™æº–èª¤",
      subtitle: "ä»¥å°çªºå¤§çš„é­”æ³•",
      intro: "çµ±è¨ˆå­¸æœ€ç¥å¥‡çš„å®šç†ä¹‹ä¸€ï¼šä¸ç®¡æ¯ç¾¤é«”é•·ä»€éº¼æ¨£å­ï¼ˆç”šè‡³æ˜¯éå¸¸å¥‡æ€ªçš„å½¢ç‹€ï¼‰ï¼Œåªè¦æ¨£æœ¬æ•¸å¤ å¤§ï¼Œæ¨£æœ¬å¹³å‡æ•¸çš„æŠ½æ¨£åˆ†ä½ˆå°±æœƒè‡ªå‹•è®Šæˆæ¼‚äº®çš„ã€Œå¸¸æ…‹åˆ†ä½ˆã€ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘èƒ½ç”¨å¸¸æ…‹æ›²ç·šä¾†é€²è¡Œæ¨è«–çš„åŸºç¤ã€‚",
      concepts: [
        { title: "ä¸­å¤®æ¥µé™å®šç† (CLT)", content: "Central Limit Theorem æŒ‡å‡ºï¼šå¾ä»»æ„æ¯ç¾¤é«”ä¸­æŠ½å–æ¨£æœ¬æ•¸ç‚º N çš„æ¨£æœ¬ï¼Œç•¶ N è¶³å¤ å¤§ï¼ˆé€šå¸¸ N > 30ï¼‰æ™‚ï¼Œé€™äº›ã€Œæ¨£æœ¬å¹³å‡æ•¸ã€çš„åˆ†ä½ˆæœƒè¶¨è¿‘æ–¼å¸¸æ…‹åˆ†ä½ˆã€‚" },
        { title: "æ¨™æº–èª¤ (Standard Error, SE)", content: "å…¬å¼ï¼šSE = Ïƒ / âˆšNã€‚\næ¨™æº–èª¤æ˜¯ã€ŒæŠ½æ¨£åˆ†ä½ˆçš„æ¨™æº–å·®ã€ã€‚å®ƒå‘Šè¨´æˆ‘å€‘ï¼šå–®æ¬¡æŠ½æ¨£çš„å¹³å‡æ•¸ï¼Œè·é›¢çœŸå¯¦çš„æ¯ç¾¤é«”å¹³å‡æ•¸ï¼Œå¹³å‡è€Œè¨€æœƒèª¤å·®å¤šå°‘ã€‚\nâ— N è¶Šå¤§ï¼Œåˆ†æ¯è¶Šå¤§ï¼ŒSE è¶Šå°ï¼ˆä¼°è¨ˆè¶Šæº–ï¼‰ã€‚" },
        { title: "ä»¥å°çªºå¤§çš„é­”æ³•", content: "å› ç‚º CLTï¼Œæˆ‘å€‘ä¸éœ€è¦èª¿æŸ¥å…¨å°ç£ 2300 è¬äººã€‚åªè¦éš¨æ©ŸæŠ½å– 1000 äºº (Nå¤ å¤§)ï¼Œç®—å‡ºå¹³å‡æ•¸å’Œæ¨™æº–èª¤ï¼Œæˆ‘å€‘å°±èƒ½ä»¥ 95% çš„ä¿¡å¿ƒæ°´æº–æ¨ä¼°æ¯ç¾¤é«”ï¼Œä¸”èª¤å·®ç¯„åœæ˜¯å¯ä»¥è¨ˆç®—çš„ï¼" }
      ],
      quizzes: [
        { 
          question: "æ ¹æ“šä¸­å¤®æ¥µé™å®šç†ï¼Œç•¶æ¨£æœ¬æ•¸ (N) å¢åŠ æ™‚ï¼Œæ¨£æœ¬å¹³å‡æ•¸çš„æŠ½æ¨£åˆ†ä½ˆå½¢ç‹€æœƒå¦‚ä½•è®ŠåŒ–ï¼Ÿ", 
          options: ["è®Šå¾—åƒæ¯ç¾¤é«”çš„å½¢ç‹€", "è®Šå¾—æ›´æ‰å¹³", "è¶¨è¿‘æ–¼å¸¸æ…‹åˆ†ä½ˆ", "è®Šæˆå‡å‹»åˆ†ä½ˆ"], 
          correctIndex: 2, 
          explanation: "æ­£ç¢ºï¼é€™å°±æ˜¯ CLT çš„æ ¸å¿ƒï¼šç„¡è«–æ¯ç¾¤é«”ç‚ºä½•ï¼ŒN å¤ å¤§æ™‚ï¼ŒæŠ½æ¨£åˆ†ä½ˆéƒ½æœƒè¶¨è¿‘å¸¸æ…‹ã€‚" 
        },
        { 
          question: "é—œæ–¼æ¨™æº–èª¤ (SE) çš„å…¬å¼ SE = Ïƒ / âˆšNï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…æ­£ç¢ºï¼Ÿ", 
          options: ["æ¨£æœ¬æ•¸ N è¶Šå¤§ï¼Œæ¨™æº–èª¤è¶Šå¤§", "æ¨£æœ¬æ•¸ N è¶Šå¤§ï¼Œæ¨™æº–èª¤è¶Šå°", "æ¨™æº–èª¤èˆ‡æ¨£æœ¬æ•¸ç„¡é—œ", "æ¨™æº–èª¤æ°¸é ç­‰æ–¼æ¨™æº–å·®"], 
          correctIndex: 1, 
          explanation: "æ­£ç¢ºï¼å› ç‚º N åœ¨åˆ†æ¯ï¼Œæ‰€ä»¥æ¨£æœ¬æ•¸è¶Šå¤§ï¼Œæ¨™æº–èª¤è¶Šå°ï¼Œä»£è¡¨æŠ½æ¨£èª¤å·®è¶Šå°ï¼Œä¼°è¨ˆè¶Šç²¾æº–ã€‚" 
        },
        { 
          question: "å¦‚æœæ¯ç¾¤é«”æ˜¯ã€Œåš´é‡å³åã€ï¼ˆä¾‹å¦‚æ‰€å¾—åˆ†ä½ˆï¼‰ï¼Œæˆ‘å€‘éš¨æ©ŸæŠ½å– N=100 çš„æ¨£æœ¬ä¾†è¨ˆç®—å¹³å‡æ‰€å¾—ã€‚è«‹å•é€™ã€Œ100å€‹æ¨£æœ¬çš„å¹³å‡æ•¸ã€ä¹‹åˆ†ä½ˆæœƒå‘ˆç¾ä»€éº¼å½¢ç‹€ï¼Ÿ", 
          options: ["åš´é‡å³å", "å¸¸æ…‹åˆ†ä½ˆ", "å‡å‹»åˆ†ä½ˆ", "é›™å³°åˆ†ä½ˆ"], 
          correctIndex: 1, 
          explanation: "æ­£ç¢ºï¼é›–ç„¶æ¯ç¾¤é«”æ˜¯åæ…‹çš„ï¼Œä½†å› ç‚º N=100 (å¤§æ–¼30)ï¼Œæ ¹æ“š CLTï¼Œæ¨£æœ¬å¹³å‡æ•¸çš„æŠ½æ¨£åˆ†ä½ˆæœƒå‘ˆç¾å¸¸æ…‹åˆ†ä½ˆã€‚" 
        }
      ]
    };

    // --- ä¸»ç¨‹å¼ ---
    function InteractiveCLT() {
      const [activeTab, setActiveTab] = useState('concept');
      
      // Simulation State
      const [popType, setPopType] = useState('normal'); // normal, uniform, skewed
      const [sampleSize, setSampleSize] = useState(5); // N
      const [isAnimating, setIsAnimating] = useState(false);

      // Data State
      const [populationData, setPopulationData] = useState([]);
      const [sampleMeans, setSampleMeans] = useState([]);
      
      // 1. Generate Population (ä¸€æ¬¡æ€§ï¼Œç•¶é¡å‹æ”¹è®Šæ™‚)
      useEffect(() => {
        const data = [];
        const n = 5000; // æ¯ç¾¤é«”å¤§å°
        for(let i=0; i<n; i++) {
          if (popType === 'normal') data.push(Random.normal(50, 15)); // Mean 50, SD 15
          else if (popType === 'uniform') data.push(Random.uniform(10, 90)); // Range 10-90
          else if (popType === 'skewed') data.push(Random.skewed(10, 90)); // Range 10-90, right skewed
        }
        setPopulationData(data);
        // Reset samples when population changes
        setSampleMeans([]);
      }, [popType]);

      // Calculate Population Stats
      const popStats = useMemo(() => {
        if (populationData.length === 0) return { mean: 0, sd: 0 };
        const sum = populationData.reduce((a,b) => a+b, 0);
        const mean = sum / populationData.length;
        const variance = populationData.reduce((a,b) => a + Math.pow(b-mean, 2), 0) / populationData.length;
        return { mean, sd: Math.sqrt(variance) };
      }, [populationData]);

      // Calculate Sample Stats
      const sampleStats = useMemo(() => {
        if (sampleMeans.length === 0) return { mean: 0, sd: 0 };
        const sum = sampleMeans.reduce((a,b) => a+b, 0);
        const mean = sum / sampleMeans.length;
        const variance = sampleMeans.reduce((a,b) => a + Math.pow(b-mean, 2), 0) / (sampleMeans.length - 1 || 1);
        // é€™è£¡çš„ SD å…¶å¯¦å°±æ˜¯ "Standard Error" (å› ç‚ºå®ƒæ˜¯ sample means çš„ SD)
        return { mean, se: Math.sqrt(variance) };
      }, [sampleMeans]);

      // Theoretical SE
      const theoreticalSE = popStats.sd / Math.sqrt(sampleSize);

      // Action: Generate Samples
      const generateSamples = (count = 1000) => {
        setIsAnimating(true);
        // ç‚ºäº†é¿å… React æ¸²æŸ“å¡é “ï¼Œä½¿ç”¨ setTimeout ç°¡å–®æ¨¡æ“¬éåŒæ­¥
        setTimeout(() => {
          const newMeans = [];
          for(let i=0; i<count; i++) {
            let sum = 0;
            for(let j=0; j<sampleSize; j++) {
              // Random sampling with replacement
              const idx = Math.floor(Math.random() * populationData.length);
              sum += populationData[idx];
            }
            newMeans.push(sum / sampleSize);
          }
          setSampleMeans(prev => [...prev, ...newMeans]); // Append new samples
          setIsAnimating(false);
        }, 50);
      };

      // Reset Samples only (Keep N and Pop)
      const clearSamples = () => setSampleMeans([]);

      // Quiz State
      const [quizState, setQuizState] = useState({});
      const [showConfetti, setShowConfetti] = useState(false);

      const handleQuizAnswer = (qIndex, optionIndex) => {
        const isCorrect = optionIndex === PAGE_DATA.quizzes[qIndex].correctIndex;
        setQuizState(prev => ({ ...prev, [qIndex]: { selected: optionIndex, isCorrect } }));
        if (isCorrect && Object.keys(quizState).length + 1 === PAGE_DATA.quizzes.length) {
          setShowConfetti(true);
          setTimeout(() => setShowConfetti(false), 3000);
        }
      };

      return (
        <div className="min-h-screen bg-slate-50 text-slate-800 font-sans p-2">
          {/* Navigation */}
          <nav className="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-slate-200 shadow-sm rounded-xl mb-4">
            <div className="max-w-5xl mx-auto px-4 py-3">
              <div className="flex flex-col md:flex-row justify-between items-center gap-4">
                <div className="flex items-center gap-2">
                  <div className="w-8 h-8 bg-violet-600 rounded-lg flex items-center justify-center text-white font-bold shadow-lg shadow-violet-200">SE</div>
                  <span className="font-bold text-xl tracking-tight text-slate-900">ä¸­å¤®æ¥µé™å®šç†èˆ‡æ¨™æº–èª¤</span>
                </div>
                <div className="flex space-x-1 bg-slate-100 p-1 rounded-xl overflow-x-auto w-full md:w-auto">
                  {[
                    { id: 'concept', label: 'æ ¸å¿ƒæ¦‚å¿µ', icon: Icons.BookOpen },
                    { id: 'sim', label: 'äº’å‹•å¯¦é©—å®¤', icon: Icons.Activity },
                    { id: 'quiz', label: 'éš¨å ‚æ¸¬é©—', icon: Icons.HelpCircle }
                  ].map((tab) => (
                    <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`flex-shrink-0 flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${activeTab === tab.id ? 'bg-white text-violet-600 shadow-sm ring-1 ring-black/5' : 'text-slate-500 hover:text-slate-700 hover:bg-slate-200/50'}`}>
                      <tab.icon />
                      <span>{tab.label}</span>
                    </button>
                  ))}
                </div>
              </div>
            </div>
          </nav>

          <main className="max-w-4xl mx-auto px-2 sm:px-6 py-4">
            <div className="mb-8 text-center">
              <h1 className="text-3xl font-extrabold text-slate-900 mb-3">{PAGE_DATA.title}</h1>
              <p className="text-lg text-slate-600 max-w-2xl mx-auto">{PAGE_DATA.intro}</p>
            </div>

            {/* TAB 1: CONCEPT */}
            {activeTab === 'concept' && (
              <div className="space-y-6 fade-in">
                <div className="grid md:grid-cols-3 gap-6">
                  {PAGE_DATA.concepts.map((item, idx) => (
                    <div key={idx} className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:border-violet-200 transition-colors">
                      <div className="w-10 h-10 bg-violet-50 text-violet-600 rounded-full flex items-center justify-center mb-4 font-bold text-lg">
                        {idx + 1}
                      </div>
                      <h3 className="font-bold text-lg text-slate-800 mb-2">{item.title}</h3>
                      <p className="text-slate-600 text-sm leading-relaxed whitespace-pre-line">
                        {item.content}
                      </p>
                    </div>
                  ))}
                </div>
                <div className="text-center mt-8">
                   <button onClick={() => setActiveTab('sim')} className="inline-flex items-center gap-2 bg-violet-600 text-white px-6 py-3 rounded-full font-medium shadow-lg shadow-violet-200 hover:bg-violet-700 transition-colors">
                    é€²å…¥å¯¦é©—å®¤è¦‹è­‰é­”æ³• <Icons.ArrowRight />
                  </button>
                </div>
              </div>
            )}

            {/* TAB 2: SIMULATION */}
            {activeTab === 'sim' && (
              <div className="grid lg:grid-cols-12 gap-8 fade-in">
                
                {/* Left Controls */}
                <div className="lg:col-span-4 space-y-6">
                  <div className="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                    <div className="flex items-center gap-2 mb-4 text-slate-800">
                      <Icons.Layers />
                      <h3 className="font-bold text-lg">å¯¦é©—æ§åˆ¶å°</h3>
                    </div>

                    {/* 1. Population Shape */}
                    <div className="mb-6">
                      <label className="block text-sm font-bold text-slate-600 mb-2">1. é¸æ“‡æ¯ç¾¤é«”å½¢ç‹€</label>
                      <div className="grid grid-cols-3 gap-2">
                        {['normal', 'uniform', 'skewed'].map(type => (
                          <button
                            key={type}
                            onClick={() => setPopType(type)}
                            className={`px-2 py-2 rounded-lg text-xs font-bold border transition-all ${popType === type ? 'bg-violet-100 border-violet-500 text-violet-700' : 'bg-white border-slate-200 text-slate-500 hover:bg-slate-50'}`}
                          >
                            {type === 'normal' ? 'å¸¸æ…‹' : type === 'uniform' ? 'å‡å‹»' : 'åæ…‹'}
                          </button>
                        ))}
                      </div>
                    </div>

                    {/* 2. Sample Size (N) */}
                    <div className="mb-6">
                      <div className="flex justify-between mb-2">
                        <label className="text-sm font-bold text-slate-600">2. æ¨£æœ¬æ•¸ (N)</label>
                        <span className="text-sm font-mono bg-violet-100 text-violet-800 px-2 rounded">{sampleSize}</span>
                      </div>
                      <input 
                        type="range" min="2" max="100" step="1" 
                        value={sampleSize} 
                        onChange={(e) => {
                          setSampleSize(Number(e.target.value));
                          clearSamples(); // N æ”¹è®Šæ™‚ï¼Œæ¸…ç©ºèˆŠæ¨£æœ¬ï¼Œå› ç‚ºå®šç¾©è®Šäº†
                        }}
                        className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-violet-600"
                      />
                      <p className="text-xs text-slate-400 mt-1">è©¦è©¦çœ‹ï¼šç•¶ N=2 èˆ‡ N=30 æ™‚æœ‰ä½•ä¸åŒï¼Ÿ</p>
                    </div>

                    {/* 3. Action Buttons */}
                    <div className="flex gap-2">
                      <button 
                        onClick={() => generateSamples(1000)}
                        disabled={isAnimating}
                        className="flex-1 bg-violet-600 text-white py-3 rounded-xl font-bold shadow-md hover:bg-violet-700 active:scale-95 transition-all disabled:opacity-50"
                      >
                        {isAnimating ? 'æŠ½æ¨£ä¸­...' : 'æŠ½å– 1000 çµ„'}
                      </button>
                      <button 
                        onClick={clearSamples}
                        className="px-4 bg-slate-100 text-slate-600 rounded-xl hover:bg-slate-200 transition-colors"
                        title="é‡ç½®æ¨£æœ¬"
                      >
                        <Icons.RefreshCw />
                      </button>
                    </div>
                  </div>

                  {/* Stats Panel */}
                  <div className="bg-indigo-50 p-4 rounded-xl border border-indigo-100 text-sm space-y-3">
                    <h4 className="font-bold text-indigo-900 border-b border-indigo-200 pb-2">çµ±è¨ˆæ•¸æ“šæ¯”è¼ƒ</h4>
                    
                    <div className="flex justify-between items-center">
                      <span className="text-slate-600">æ¯ç¾¤é«” SD (Ïƒ)</span>
                      <span className="font-mono font-bold text-slate-800">{popStats.sd.toFixed(2)}</span>
                    </div>

                    <div className="flex justify-between items-center">
                      <span className="text-violet-700 font-bold">ç†è«–æ¨™æº–èª¤ (Ïƒ/âˆšN)</span>
                      <span className="font-mono font-bold text-violet-700">{theoreticalSE.toFixed(2)}</span>
                    </div>

                    <div className="flex justify-between items-center">
                      <span className="text-emerald-700 font-bold">å¯¦éš›æ¨™æº–èª¤ (æ¨£æœ¬SD)</span>
                      <span className="font-mono font-bold text-emerald-700">
                        {sampleMeans.length > 1 ? sampleStats.se.toFixed(2) : '-'}
                      </span>
                    </div>
                    
                    {sampleMeans.length > 100 && (
                      <div className="text-xs text-slate-500 mt-2 pt-2 border-t border-indigo-200">
                        è§€å¯Ÿï¼šéš¨è‘—æŠ½æ¨£æ¬¡æ•¸å¢åŠ ï¼Œã€Œå¯¦éš›æ¨™æº–èª¤ã€æœƒè¶Šä¾†è¶Šæ¥è¿‘ã€Œç†è«–æ¨™æº–èª¤ã€ã€‚
                      </div>
                    )}
                  </div>
                </div>

                {/* Right Graphs */}
                <div className="lg:col-span-8 space-y-6">
                  
                  {/* Graph 1: Population */}
                  <div className="bg-white p-4 rounded-2xl border border-slate-200 shadow-sm">
                    <div className="flex justify-between items-end mb-2">
                      <h3 className="font-bold text-slate-700">æ¯ç¾¤é«”åˆ†ä½ˆ (Population)</h3>
                      <span className="text-xs text-slate-400">N = 1 (åŸå§‹æ•¸æ“š)</span>
                    </div>
                    <Histogram 
                      data={populationData} 
                      range={[0, 100]} 
                      color="#94a3b8" // slate-400
                      label="æ¯ç¾¤é«”"
                      meanLine={popStats.mean}
                    />
                    <div className="text-xs text-slate-500 mt-2 text-center">
                      é€™æ˜¯åŸå§‹è³‡æ–™çš„é•·ç›¸ã€‚{popType === 'uniform' ? 'å¹³å¹³çš„' : popType === 'skewed' ? 'æ­ªä¸€é‚Šçš„' : 'ä¸­é–“é«˜çš„'}ã€‚
                    </div>
                  </div>

                  {/* Graph 2: Sampling Distribution */}
                  <div className="bg-white p-4 rounded-2xl border-2 border-violet-100 shadow-lg relative overflow-hidden">
                    <div className="flex justify-between items-end mb-2">
                      <h3 className="font-bold text-violet-700 flex items-center gap-2">
                        æŠ½æ¨£åˆ†ä½ˆ (Sampling Distribution)
                        {sampleMeans.length > 0 && <span className="bg-violet-100 text-violet-800 text-xs px-2 py-0.5 rounded-full">Samples: {sampleMeans.length}</span>}
                      </h3>
                      <span className="text-xs text-violet-400 font-bold">N = {sampleSize} (å¹³å‡æ•¸)</span>
                    </div>
                    
                    {sampleMeans.length === 0 ? (
                      <div className="h-40 flex flex-col items-center justify-center text-slate-400 bg-slate-50 rounded-lg border border-dashed border-slate-300">
                        <Icons.Activity />
                        <span className="mt-2 text-sm">è«‹é»æ“Šå·¦å´ã€ŒæŠ½å–æ¨£æœ¬ã€æŒ‰éˆ•</span>
                      </div>
                    ) : (
                      <Histogram 
                        data={sampleMeans} 
                        range={[0, 100]} 
                        color="#8b5cf6" // violet-500
                        label="æŠ½æ¨£åˆ†ä½ˆ"
                        meanLine={sampleStats.mean}
                      />
                    )}

                    <div className="text-xs text-violet-600 mt-2 text-center font-medium bg-violet-50 p-2 rounded">
                      {sampleMeans.length < 50 
                        ? "æ¨£æœ¬é‚„ä¸å¤ å¤šï¼Œå½¢ç‹€é‚„ä¸æ˜é¡¯..." 
                        : (sampleSize < 5 
                           ? "å› ç‚º N å¾ˆå°ï¼ŒæŠ½æ¨£åˆ†ä½ˆçš„å½¢ç‹€é‚„å¾ˆåƒæ¯ç¾¤é«” (å¦‚æœæ˜¯åæ…‹çš„è©±)ã€‚" 
                           : "çœ‹ï¼å³ä½¿æ¯ç¾¤é«”é•·å¾—å¾ˆå¥‡æ€ªï¼Œé€™è£¡ä¹Ÿè®Šæˆäº†æ¼‚äº®çš„å¸¸æ…‹åˆ†ä½ˆ (é˜å½¢)ï¼é€™å°±æ˜¯ CLTï¼")}
                    </div>
                  </div>
                  
                </div>
              </div>
            )}

            {/* TAB 3: QUIZ */}
            {activeTab === 'quiz' && (
              <div className="space-y-6 fade-in animate-slide-up">
                 <div className="bg-violet-50 rounded-xl p-6 border border-violet-100 mb-6 flex gap-4">
                    <div className="bg-violet-100 p-3 rounded-full h-fit"><Icons.HelpCircle /></div>
                    <div><h3 className="font-bold text-violet-900 text-lg">éš¨å ‚æ¸¬é©—</h3><p className="text-violet-700 mt-1">ç¢ºèªæ‚¨æ˜¯å¦ç†è§£ CLT èˆ‡ SE çš„æ ¸å¿ƒæ¦‚å¿µã€‚</p></div>
                  </div>
                {PAGE_DATA.quizzes.map((quiz, qIndex) => {
                  const state = quizState[qIndex];
                  const isAnswered = state !== undefined;
                  return (
                    <div key={qIndex} className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                      <div className="p-6 border-b border-slate-100 bg-slate-50/50">
                        <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">Question {qIndex + 1}</span>
                        <h3 className="text-lg font-semibold text-slate-800 mt-2">{quiz.question}</h3>
                      </div>
                      <div className="p-4 space-y-2">
                        {quiz.options.map((option, oIndex) => {
                          let btnClass = "w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex justify-between items-center ";
                          if (!isAnswered) { btnClass += "border-slate-100 hover:border-violet-200 hover:bg-violet-50 text-slate-600"; } else { if (oIndex === quiz.correctIndex) { btnClass += "border-green-500 bg-green-50 text-green-800 font-medium"; } else if (state.selected === oIndex && !state.isCorrect) { btnClass += "border-red-300 bg-red-50 text-red-800 opacity-70"; } else { btnClass += "border-transparent text-slate-400 opacity-50 cursor-default"; } }
                          return (
                            <button key={oIndex} onClick={() => !isAnswered && handleQuizAnswer(qIndex, oIndex)} disabled={isAnswered} className={btnClass}>
                              <span>{option}</span>
                              {isAnswered && oIndex === quiz.correctIndex && <Icons.CheckCircle />}
                              {isAnswered && state.selected === oIndex && !state.isCorrect && <Icons.XCircle />}
                            </button>
                          );
                        })}
                      </div>
                      {isAnswered && <div className={`p-5 mx-4 mb-4 rounded-xl text-sm ${state.isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}><p className="font-bold mb-1">{state.isCorrect ? 'ğŸ‰ ç­”å°äº†ï¼' : 'ğŸ’¡ å†æƒ³ä¸€ä¸‹...'}</p><p>{quiz.explanation}</p></div>}
                    </div>
                  );
                })}
                {showConfetti && <div className="text-center p-4 bg-violet-100 text-violet-800 font-bold rounded-xl animate-pulse">å¤ªæ£’äº†ï¼æ‚¨å·²ç¶“æŒæ¡äº†çµ±è¨ˆæ¨è«–çš„åŸºçŸ³ï¼</div>}
              </div>
            )}
          </main>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<InteractiveCLT />);
  </script>
</body>
</html>
